// CategoryChips.jsx
import { useState } from "react";
import styled from "styled-components";

// ── 인라인 SVG 아이콘 (필요하면 네가 가진 path로 교체해도 됨)
const IconFood = () => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="12"
    height="14"
    viewBox="0 0 12 14"
    fill="none"
  >
    <path
      d="M2.82422 0.495605C3.68095 0.49565 4.40317 0.88447 4.88672 1.42432C5.37013 1.9642 5.64844 2.68395 5.64844 3.45264C5.64835 4.22118 5.37005 4.94019 4.88672 5.47998C4.54268 5.86412 4.07746 6.17031 3.5293 6.31592V12.9136C3.52926 13.24 3.21296 13.5042 2.82324 13.5044C2.43334 13.5044 2.11722 13.2401 2.11719 12.9136V6.31592C1.56958 6.17011 1.10448 5.86387 0.760742 5.47998C0.27746 4.9402 9.08973e-05 4.22114 0 3.45264C0 2.68395 0.277329 1.9642 0.760742 1.42432C1.24432 0.884263 1.96724 0.495605 2.82422 0.495605ZM8.47266 0.495605C8.86237 0.495807 9.17871 0.760944 9.17871 1.0874V12.9136C9.17867 13.24 8.86235 13.5042 8.47266 13.5044C8.08276 13.5044 7.76664 13.2401 7.7666 12.9136V1.0874C7.7666 0.760819 8.08273 0.495605 8.47266 0.495605ZM10.6904 0.495605C11.0802 0.495728 11.3965 0.760895 11.3965 1.0874V12.9136C11.3964 13.2401 11.0802 13.5043 10.6904 13.5044C10.3005 13.5044 9.98442 13.2401 9.98438 12.9136V1.0874C9.98438 0.760819 10.3005 0.495605 10.6904 0.495605Z"
      fill="#1DC3FF"
    />
  </svg>
);
const IconCafe = () => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="12"
    height="12"
    viewBox="0 0 12 12"
    fill="none"
  >
    <path
      d="M0.705882 1.23333C0.705882 0.827708 1.02132 0.5 1.41176 0.5H9.17647C10.736 0.5 12 1.81313 12 3.43333C12 5.05354 10.736 6.36667 9.17647 6.36667C9.17647 7.58125 8.22794 8.56667 7.05882 8.56667H2.82353C1.65441 8.56667 0.705882 7.58125 0.705882 6.36667V1.23333ZM10.5882 3.43333C10.5882 2.62438 9.95515 1.96667 9.17647 1.96667V4.9C9.95515 4.9 10.5882 4.24229 10.5882 3.43333ZM0.705882 10.0333H9.17647C9.56691 10.0333 9.88235 10.361 9.88235 10.7667C9.88235 11.1723 9.56691 11.5 9.17647 11.5H0.705882C0.315441 11.5 0 11.1723 0 10.7667C0 10.361 0.315441 10.0333 0.705882 10.0333Z"
      fill="#1DC3FF"
    />
  </svg>
);
const IconStore = () => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="13"
    height="12"
    viewBox="0 0 13 12"
    fill="none"
  >
    <path
      d="M3.91184 10H5.85278V9.33333H4.55882V8.66667H5.85278V6.66667H3.91184V7.33333H5.2058V8H3.91184V10ZM8.4407 10H9.08768V6.66667H8.4407V8H7.79372V6.66667H7.14674V8.66667H8.4407V10ZM12.3226 5.36667V10.6667C12.3226 11.0333 12.196 11.3473 11.9428 11.6087C11.6896 11.87 11.3849 12.0004 11.0286 12H1.97091C1.61507 12 1.31056 11.8696 1.05737 11.6087C0.804186 11.3478 0.677378 11.0338 0.676947 10.6667V5.36667C0.428938 5.13333 0.237648 4.83333 0.103076 4.46667C-0.0314955 4.1 -0.0342991 3.7 0.0946655 3.26667L0.773994 1C0.860258 0.711111 1.01402 0.472222 1.23529 0.283333C1.45656 0.0944444 1.71255 0 2.00325 0H10.9963C11.2874 0 11.5408 0.0917778 11.7565 0.275333C11.9721 0.458889 12.1285 0.700444 12.2255 1L12.9049 3.26667C13.0343 3.7 13.0317 4.09444 12.8971 4.45C12.7625 4.80555 12.571 5.11111 12.3226 5.36667ZM7.92312 4.66667C8.21426 4.66667 8.43531 4.564 8.58627 4.35867C8.73723 4.15333 8.79654 3.92267 8.76419 3.66667L8.40835 1.33333H7.14674V3.8C7.14674 4.03333 7.22222 4.23622 7.37318 4.40867C7.52415 4.58111 7.70746 4.66711 7.92312 4.66667ZM5.01171 4.66667C5.25972 4.66667 5.46201 4.58044 5.61858 4.408C5.77514 4.23556 5.85321 4.03289 5.85278 3.8V1.33333H4.59117L4.23533 3.66667C4.1922 3.93333 4.2487 4.16667 4.40484 4.36667C4.56098 4.56667 4.76327 4.66667 5.01171 4.66667ZM2.13265 4.66667C2.32674 4.66667 2.49647 4.59444 2.64182 4.45C2.78718 4.30555 2.87625 4.12222 2.90903 3.9L3.26486 1.33333H2.00325L1.35628 3.56667C1.29158 3.78889 1.32651 4.02778 1.46109 4.28333C1.59566 4.53889 1.81951 4.66667 2.13265 4.66667ZM10.8669 4.66667C11.1796 4.66667 11.406 4.53889 11.5462 4.28333C11.6864 4.02778 11.7187 3.78889 11.6432 3.56667L10.9639 1.33333H9.73466L10.0905 3.9C10.1228 4.12222 10.2119 4.30555 10.3577 4.45C10.5035 4.59444 10.6732 4.66667 10.8669 4.66667Z"
      fill="#1DC3FF"
    />
  </svg>
);

const IconHospital = () => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="13"
    height="12"
    viewBox="0 0 13 12"
    fill="none"
  >
    <path
      d="M3.91184 10H5.85278V9.33333H4.55882V8.66667H5.85278V6.66667H3.91184V7.33333H5.2058V8H3.91184V10ZM8.4407 10H9.08768V6.66667H8.4407V8H7.79372V6.66667H7.14674V8.66667H8.4407V10ZM12.3226 5.36667V10.6667C12.3226 11.0333 12.196 11.3473 11.9428 11.6087C11.6896 11.87 11.3849 12.0004 11.0286 12H1.97091C1.61507 12 1.31056 11.8696 1.05737 11.6087C0.804186 11.3478 0.677378 11.0338 0.676947 10.6667V5.36667C0.428938 5.13333 0.237648 4.83333 0.103076 4.46667C-0.0314955 4.1 -0.0342991 3.7 0.0946655 3.26667L0.773994 1C0.860258 0.711111 1.01402 0.472222 1.23529 0.283333C1.45656 0.0944444 1.71255 0 2.00325 0H10.9963C11.2874 0 11.5408 0.0917778 11.7565 0.275333C11.9721 0.458889 12.1285 0.700444 12.2255 1L12.9049 3.26667C13.0343 3.7 13.0317 4.09444 12.8971 4.45C12.7625 4.80555 12.571 5.11111 12.3226 5.36667ZM7.92312 4.66667C8.21426 4.66667 8.43531 4.564 8.58627 4.35867C8.73723 4.15333 8.79654 3.92267 8.76419 3.66667L8.40835 1.33333H7.14674V3.8C7.14674 4.03333 7.22222 4.23622 7.37318 4.40867C7.52415 4.58111 7.70746 4.66711 7.92312 4.66667ZM5.01171 4.66667C5.25972 4.66667 5.46201 4.58044 5.61858 4.408C5.77514 4.23556 5.85321 4.03289 5.85278 3.8V1.33333H4.59117L4.23533 3.66667C4.1922 3.93333 4.2487 4.16667 4.40484 4.36667C4.56098 4.56667 4.76327 4.66667 5.01171 4.66667ZM2.13265 4.66667C2.32674 4.66667 2.49647 4.59444 2.64182 4.45C2.78718 4.30555 2.87625 4.12222 2.90903 3.9L3.26486 1.33333H2.00325L1.35628 3.56667C1.29158 3.78889 1.32651 4.02778 1.46109 4.28333C1.59566 4.53889 1.81951 4.66667 2.13265 4.66667ZM10.8669 4.66667C11.1796 4.66667 11.406 4.53889 11.5462 4.28333C11.6864 4.02778 11.7187 3.78889 11.6432 3.56667L10.9639 1.33333H9.73466L10.0905 3.9C10.1228 4.12222 10.2119 4.30555 10.3577 4.45C10.5035 4.59444 10.6732 4.66667 10.8669 4.66667Z"
      fill="#1DC3FF"
    />
  </svg>
);

const IconPharmacy = () => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="13"
    height="14"
    viewBox="0 0 13 14"
    fill="none"
  >
    <path
      fill-rule="evenodd"
      clip-rule="evenodd"
      d="M9.33218 0.91294L7.36418 3.99694H10.4472L11.5312 2.32894C11.7191 2.0372 11.7834 1.68277 11.71 1.34361C11.6366 1.00445 11.4314 0.708346 11.1397 0.52044C10.8479 0.332534 10.4935 0.268217 10.1543 0.341638C9.81519 0.415058 9.51909 0.620202 9.33118 0.91194M0.29618 8.68794L0.00617969 6.10794C-0.0094383 5.96811 0.00462821 5.82655 0.0474599 5.69253C0.0902916 5.5585 0.160924 5.43502 0.254741 5.33016C0.348558 5.22531 0.463448 5.14142 0.5919 5.084C0.720353 5.02658 0.859477 4.99691 1.00018 4.99694H11.4582C11.599 4.9969 11.7382 5.02659 11.8667 5.08407C11.9953 5.14155 12.1102 5.22553 12.204 5.3305C12.2979 5.43547 12.3685 5.55907 12.4112 5.69322C12.454 5.82736 12.4679 5.96903 12.4522 6.10894L12.1622 8.68894C12.0904 9.32676 11.8663 9.93794 11.5086 10.4709C11.1509 11.0038 10.6702 11.4429 10.1072 11.7509C10.2632 12.0579 10.3732 12.3939 10.4272 12.7509C10.4446 12.8671 10.4367 12.9857 10.4041 13.0985C10.3715 13.2114 10.3149 13.3159 10.2382 13.4048C10.1615 13.4938 10.0664 13.5651 9.9596 13.614C9.85277 13.6629 9.73665 13.6881 9.61918 13.6879H2.83918C2.72171 13.6881 2.60559 13.6629 2.49876 13.614C2.39193 13.5651 2.29691 13.4938 2.22019 13.4048C2.14347 13.3159 2.08687 13.2114 2.05425 13.0985C2.02163 12.9857 2.01376 12.8671 2.03118 12.7509C2.0838 12.4027 2.19183 12.0651 2.35118 11.7509C1.78798 11.4428 1.30723 11.0036 0.949552 10.4704C0.591872 9.93732 0.36777 9.32593 0.29618 8.68794ZM6.85418 7.41294C6.85418 7.24718 6.78833 7.08821 6.67112 6.971C6.55391 6.85379 6.39494 6.78794 6.22918 6.78794C6.06342 6.78794 5.90445 6.85379 5.78724 6.971C5.67003 7.08821 5.60418 7.24718 5.60418 7.41294V8.71694H4.30018C4.2181 8.71694 4.13683 8.73311 4.061 8.76452C3.98517 8.79593 3.91627 8.84196 3.85824 8.9C3.8002 8.95804 3.75416 9.02693 3.72275 9.10276C3.69135 9.17859 3.67518 9.25986 3.67518 9.34194C3.67518 9.42402 3.69135 9.50529 3.72275 9.58112C3.75416 9.65695 3.8002 9.72585 3.85824 9.78388C3.91627 9.84192 3.98517 9.88796 4.061 9.91936C4.13683 9.95077 4.2181 9.96694 4.30018 9.96694H5.60418V11.2719C5.60418 11.4377 5.67003 11.5967 5.78724 11.7139C5.90445 11.8311 6.06342 11.8969 6.22918 11.8969C6.39494 11.8969 6.55391 11.8311 6.67112 11.7139C6.78833 11.5967 6.85418 11.4377 6.85418 11.2719V9.96794H8.15818C8.32394 9.96794 8.48291 9.90209 8.60012 9.78488C8.71733 9.66767 8.78318 9.5087 8.78318 9.34294C8.78318 9.17718 8.71733 9.01821 8.60012 8.901C8.48291 8.78379 8.32394 8.71794 8.15818 8.71794H6.85418V7.41294Z"
      fill="#1DC3FF"
    />
  </svg>
);
const IconLife = () => (
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="12"
    height="12"
    viewBox="0 0 12 12"
    fill="none"
  >
    <path
      d="M6.35476 11.6109L6.34816 11.6121L6.30556 11.6331L6.29356 11.6355L6.28516 11.6331L6.24256 11.6121C6.23616 11.6101 6.23136 11.6111 6.22816 11.6151L6.22576 11.6211L6.21556 11.8779L6.21856 11.8899L6.22456 11.8977L6.28696 11.9421L6.29596 11.9445L6.30316 11.9421L6.36556 11.8977L6.37276 11.8881L6.37516 11.8779L6.36496 11.6217C6.36336 11.6153 6.35996 11.6117 6.35476 11.6109ZM6.51376 11.5431L6.50596 11.5443L6.39496 11.6001L6.38896 11.6061L6.38716 11.6127L6.39796 11.8707L6.40096 11.8779L6.40576 11.8821L6.52636 11.9379C6.53396 11.9399 6.53976 11.9383 6.54376 11.9331L6.54616 11.9247L6.52576 11.5563C6.52376 11.5491 6.51976 11.5447 6.51376 11.5431ZM6.08476 11.5443C6.08211 11.5427 6.07895 11.5422 6.07593 11.5429C6.07291 11.5436 6.07027 11.5454 6.06856 11.5479L6.06496 11.5563L6.04456 11.9247C6.04496 11.9319 6.04836 11.9367 6.05476 11.9391L6.06376 11.9379L6.18436 11.8821L6.19036 11.8773L6.19276 11.8707L6.20296 11.6127L6.20116 11.6055L6.19516 11.5995L6.08476 11.5443Z"
      fill="#1DC3FF"
    />
    <path
      d="M11.4 1.85591C11.5591 1.85591 11.7117 1.91912 11.8243 2.03164C11.9368 2.14417 12 2.29678 12 2.45591C12 2.61504 11.9368 2.76765 11.8243 2.88017C11.7117 2.99269 11.5591 3.05591 11.4 3.05591V9.05591C11.5591 9.05591 11.7117 9.11912 11.8243 9.23164C11.9368 9.34416 12 9.49678 12 9.65591C12 9.81504 11.9368 9.96765 11.8243 10.0802C11.7117 10.1927 11.5591 10.2559 11.4 10.2559H0.6C0.44087 10.2559 0.288258 10.1927 0.175736 10.0802C0.0632141 9.96765 0 9.81504 0 9.65591C0 9.49678 0.0632141 9.34416 0.175736 9.23164C0.288258 9.11912 0.44087 9.05591 0.6 9.05591V3.05591C0.44087 3.05591 0.288258 2.99269 0.175736 2.88017C0.0632141 2.76765 0 2.61504 0 2.45591C0 2.29678 0.0632141 2.14417 0.175736 2.03164C0.288258 1.91912 0.44087 1.85591 0.6 1.85591H11.4ZM3 4.25591C2.84087 4.25591 2.68826 4.31912 2.57574 4.43164C2.46321 4.54417 2.4 4.69678 2.4 4.85591V9.05591H3.6V4.85591C3.6 4.69678 3.53679 4.54417 3.42426 4.43164C3.31174 4.31912 3.15913 4.25591 3 4.25591ZM6 4.25591C5.84087 4.25591 5.68826 4.31912 5.57574 4.43164C5.46321 4.54417 5.4 4.69678 5.4 4.85591V9.05591H6.6V4.85591C6.6 4.69678 6.53679 4.54417 6.42426 4.43164C6.31174 4.31912 6.15913 4.25591 6 4.25591ZM9 4.25591C8.84087 4.25591 8.68826 4.31912 8.57574 4.43164C8.46321 4.54417 8.4 4.69678 8.4 4.85591V9.05591H9.6V4.85591C9.6 4.69678 9.53679 4.54417 9.42426 4.43164C9.31174 4.31912 9.15913 4.25591 9 4.25591ZM9.6 0.0559082C9.75913 0.0559082 9.91174 0.119122 10.0243 0.231644C10.1368 0.344166 10.2 0.496778 10.2 0.655908C10.2 0.815038 10.1368 0.96765 10.0243 1.08017C9.91174 1.19269 9.75913 1.25591 9.6 1.25591H2.4C2.24087 1.25591 2.08826 1.19269 1.97574 1.08017C1.86321 0.96765 1.8 0.815038 1.8 0.655908C1.8 0.496778 1.86321 0.344166 1.97574 0.231644C2.08826 0.119122 2.24087 0.0559082 2.4 0.0559082H9.6Z"
      fill="#1DC3FF"
    />
  </svg>
);

// 기본 카테고리(키/라벨 고정)
const BASE = [
  { key: "food", label: "음식점", Icon: IconFood },
  { key: "cafe", label: "카페", Icon: IconCafe },
  { key: "store", label: "편의점", Icon: IconStore },
  { key: "hos", label: "병원", Icon: IconHospital },
  { key: "pha", label: "약국", Icon: IconPharmacy },
  { key: "life", label: "생활기관", Icon: IconLife },
];

/**
 * props:
 *  - variant: "map" | "search"
 *  - onSelect?: (key) => void
 */
export default function MapSearchCategoryChips({ variant = "map", onSelect }) {
  const [active, setActive] = useState(null);

  // 색 테마: 맵은 기본 흰/파랑, 검색 페이지는 기본 하늘/흰 → 활성 시 반전
  const theme =
    variant === "search"
      ? {
          offBg: "#33C9FF",
          offFg: "#fff",
          onBg: "#fff",
          onFg: "#33C9FF",
          border: "#33C9FF",
        }
      : {
          offBg: "#fff",
          offFg: "#333",
          onBg: "#EEF4FF",
          onFg: "#2B7CFF",
          border: "#2B7CFF",
        };

  const handle = (key) => {
    setActive(key);
    onSelect?.(key);
  };

  return (
    <BarWrap>
      <Scroller>
        {BASE.map(({ key, label, Icon }) => {
          const isOn = active === key;
          return (
            <Chip
              key={key}
              $bg={isOn ? theme.onBg : theme.offBg}
              $fg={isOn ? theme.onFg : theme.offFg}
              $bd={isOn ? theme.border : "#e5e7eb"}
              type="button"
              onClick={() => handle(key)}
            >
              <Icon />
              <span>{label}</span>
            </Chip>
          );
        })}
      </Scroller>
    </BarWrap>
  );
}

/* ========== styles ========== */

const BarWrap = styled.div`
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  top: calc(env(safe-area-inset-top, 0px) + 18px + 64px);
  width: 100%;
  max-width: 430px;
  padding: 0 17px;
  z-index: 9998;
  pointer-events: none;
`;

const Scroller = styled.div`
  pointer-events: auto;
  display: flex;
  gap: 8px;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  padding: 6px 2px;
  scrollbar-width: none;
  &::-webkit-scrollbar {
    display: none;
  }
`;

const Chip = styled.button`
  flex: 0 0 auto;
  border: 1px solid ${(p) => p.$bd};
  background: ${(p) => p.$bg};
  color: ${(p) => p.$fg}; /* ← 텍스트 & 아이콘 동시에 이 색으로 */
  padding: 8px 12px;
  border-radius: 999px;
  font-size: 14px;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  -webkit-tap-highlight-color: transparent;

  /* SVG도 현재 color를 따르게 */
  svg {
    display: block;
  }
  svg path,
  svg rect,
  svg circle,
  svg polygon,
  svg line {
    fill: currentColor;
    stroke: currentColor;
  }
`;
